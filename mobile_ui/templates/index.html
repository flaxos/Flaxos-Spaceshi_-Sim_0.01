<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Flaxos Mobile Station Console</title>
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <header class="app-header">
      <div>
        <h1>Flaxos Mobile Station Console</h1>
        <p>Socket protocol client for Nav, Tactical, and Power stations.</p>
      </div>
    </header>

    <main class="layout">
      <section class="panel">
        <h2>Connection</h2>
        <div class="grid two">
          <label>
            Host
            <input id="host" type="text" value="{{ default_host }}" />
          </label>
          <label>
            Port
            <input id="port" type="number" inputmode="numeric" value="{{ default_port }}" />
          </label>
        </div>
        <label>
          Ship ID
          <input id="ship" type="text" value="test_ship_001" />
        </label>
        <div class="actions">
          <button data-action="test-connection">Test Connection</button>
          <button data-action="get-state">Get State</button>
        </div>
      </section>

      <section class="panel">
        <h2>Scenario Control</h2>
        <label>
          Scenario
          <select id="scenario-select"></select>
        </label>
        <div class="actions">
          <button data-action="refresh-scenarios">Refresh List</button>
          <button data-action="load-scenario">Load Scenario</button>
        </div>
        <div class="status-grid compact">
          <div class="status-item">
            <div class="status-label">Name</div>
            <div class="status-value" id="scenario-name">--</div>
          </div>
          <div class="status-item">
            <div class="status-label">Description</div>
            <div class="status-value" id="scenario-description">--</div>
          </div>
        </div>
      </section>

      <section class="panel">
        <h2>Mission</h2>
        <div class="status-grid compact">
          <div class="status-item">
            <div class="status-label">Status</div>
            <div class="status-value" id="mission-status">--</div>
            <span class="led" id="mission-status-led"></span>
          </div>
          <div class="status-item">
            <div class="status-label">Progress</div>
            <div class="status-value" id="mission-progress">--</div>
          </div>
          <div class="status-item">
            <div class="status-label">Time Remaining</div>
            <div class="status-value" id="mission-time">--</div>
          </div>
        </div>
        <div class="mission-copy">
          <div class="mission-title" id="mission-name">--</div>
          <div class="mission-desc" id="mission-description">--</div>
          <div class="mission-briefing" id="mission-briefing">--</div>
        </div>
        <div id="mission-objectives" class="mission-objectives"></div>
        <div class="mission-hints">
          <h3>Hints</h3>
          <div id="mission-hints" class="mission-hint-list"></div>
        </div>
      </section>

      <section class="panel">
        <h2>Ship Status</h2>
        <div class="status-grid">
          <div class="status-item">
            <div class="status-label">Ship</div>
            <div class="status-value" id="ship-name">--</div>
          </div>
          <div class="status-item">
            <div class="status-label">Class</div>
            <div class="status-value" id="ship-class">--</div>
          </div>
          <div class="status-item">
            <div class="status-label">Hull</div>
            <div class="status-value" id="ship-hull">--</div>
            <span class="led" id="ship-hull-led"></span>
          </div>
          <div class="status-item">
            <div class="status-label">Velocity</div>
            <div class="status-value" id="ship-velocity">--</div>
          </div>
          <div class="status-item">
            <div class="status-label">Position</div>
            <div class="status-value" id="ship-position">--</div>
          </div>
          <div class="status-item">
            <div class="status-label">Nav Mode</div>
            <div class="status-value" id="ship-nav-mode">--</div>
          </div>
        </div>
      </section>

      <section class="panel">
        <h2>Nav / Helm</h2>
        <div class="status-grid compact">
          <div class="status-item">
            <div class="status-label">Autopilot</div>
            <div class="status-value" id="nav-autopilot">--</div>
            <span class="led" id="nav-autopilot-led"></span>
          </div>
          <div class="status-item">
            <div class="status-label">Target</div>
            <div class="status-value" id="nav-target-status">--</div>
          </div>
          <div class="status-item">
            <div class="status-label">Thrust</div>
            <div class="status-value" id="nav-thrust-status">--</div>
          </div>
        </div>
        <div class="grid three">
          <label>
            Thrust X
            <input id="thrust-x" type="number" step="0.1" value="0" />
          </label>
          <label>
            Thrust Y
            <input id="thrust-y" type="number" step="0.1" value="0" />
          </label>
          <label>
            Thrust Z
            <input id="thrust-z" type="number" step="0.1" value="0" />
          </label>
        </div>
        <div class="actions compact">
          <button data-adjust="thrust-x" data-step="0.1">+X</button>
          <button data-adjust="thrust-x" data-step="-0.1">-X</button>
          <button data-adjust="thrust-y" data-step="0.1">+Y</button>
          <button data-adjust="thrust-y" data-step="-0.1">-Y</button>
          <button data-adjust="thrust-z" data-step="0.1">+Z</button>
          <button data-adjust="thrust-z" data-step="-0.1">-Z</button>
        </div>
        <button data-action="set-thrust">Send Thrust</button>

        <div class="grid three">
          <label>
            Course X
            <input id="course-x" type="number" step="0.1" value="0" />
          </label>
          <label>
            Course Y
            <input id="course-y" type="number" step="0.1" value="0" />
          </label>
          <label>
            Course Z
            <input id="course-z" type="number" step="0.1" value="0" />
          </label>
        </div>
        <button data-action="set-course">Set Course</button>

        <div class="grid two">
          <label>
            Autopilot
            <select id="autopilot">
              <option value="true">Engage</option>
              <option value="false">Disengage</option>
            </select>
          </label>
          <label>
            Target ID
            <input id="nav-target" type="text" placeholder="target id" />
          </label>
        </div>
        <div class="actions">
          <button data-action="set-autopilot">Set Autopilot</button>
          <button data-action="set-target">Set Target</button>
        </div>
      </section>

      <section class="panel">
        <h2>Tactical</h2>
        <div class="status-grid compact">
          <div class="status-item">
            <div class="status-label">Weapons</div>
            <div class="status-value" id="tactical-weapons-status">--</div>
            <span class="led" id="tactical-weapons-led"></span>
          </div>
          <div class="status-item">
            <div class="status-label">Locked Target</div>
            <div class="status-value" id="tactical-locked-target">--</div>
          </div>
        </div>
        <label>
          Target ID
          <input id="tactical-target" type="text" placeholder="target id" />
        </label>
        <div class="grid two">
          <label>
            Sensor Mode
            <select id="sensor-mode">
              <option value="active">Active</option>
              <option value="passive">Passive</option>
            </select>
          </label>
          <label>
            Ping Count
            <input id="sensor-count" type="number" value="1" min="1" />
          </label>
        </div>
        <div class="actions">
          <button data-action="ping-sensors">Ping Sensors</button>
          <button data-action="fire-weapon">Fire Weapon</button>
        </div>
        <div class="actions compact">
          <button data-adjust="sensor-count" data-step="1">+Ping</button>
          <button data-adjust="sensor-count" data-step="-1">-Ping</button>
        </div>
      </section>

      <section class="panel">
        <h2>Power</h2>
        <div class="status-grid compact">
          <div class="status-item">
            <div class="status-label">Power Status</div>
            <div class="status-value" id="power-status">--</div>
            <span class="led" id="power-status-led"></span>
          </div>
          <div class="status-item">
            <div class="status-label">Stored</div>
            <div class="status-value" id="power-stored">--</div>
          </div>
          <div class="status-item">
            <div class="status-label">Draw</div>
            <div class="status-value" id="power-draw">--</div>
          </div>
        </div>
        <label>
          System Name
          <input id="power-system" type="text" value="railgun" />
        </label>
        <label class="inline">
          <input id="power-state" type="checkbox" checked />
          Enabled
        </label>
        <button data-action="toggle-system">Toggle System</button>

        <div class="grid three">
          <label>
            Primary
            <input id="power-primary" type="number" step="0.05" value="0.5" />
          </label>
          <label>
            Secondary
            <input id="power-secondary" type="number" step="0.05" value="0.3" />
          </label>
          <label>
            Tertiary
            <input id="power-tertiary" type="number" step="0.05" value="0.2" />
          </label>
        </div>
        <button data-action="set-power-allocation">Set Allocation</button>
      </section>

      <section class="panel">
        <h2>System Updates</h2>
        <div id="version-info" class="version-display">
          <p>Current Version: <strong id="current-version">Loading...</strong></p>
          <p>Build: <strong id="current-build">-</strong></p>
          <p>Release Date: <strong id="release-date">-</strong></p>
        </div>
        <div id="update-status" class="update-status"></div>
        <div class="actions">
          <button data-action="check-update">Check for Updates</button>
          <button data-action="apply-update" id="apply-update-btn" style="display:none;">Apply Update</button>
        </div>
        <div id="update-changelog" class="changelog" style="display:none;"></div>
      </section>

      <section class="panel">
        <h2>Sensors</h2>
        <div class="status-grid compact">
          <div class="status-item">
            <div class="status-label">Ping Ready</div>
            <div class="status-value" id="sensor-ping-ready">--</div>
            <span class="led" id="sensor-ping-led"></span>
          </div>
          <div class="status-item">
            <div class="status-label">Cooldown</div>
            <div class="status-value" id="sensor-ping-cooldown">--</div>
          </div>
          <div class="status-item">
            <div class="status-label">Contacts</div>
            <div class="status-value" id="sensor-contact-count">--</div>
          </div>
        </div>
        <div id="sensor-contacts" class="contact-list"></div>
      </section>

      <section class="panel log">
        <h2>Command Log</h2>
        <div id="structured-log" class="structured-log"></div>
        <details class="raw-log">
          <summary>Raw Log</summary>
          <div id="log"></div>
        </details>
      </section>
    </main>

    <script src="/static/app.js"></script>
  </body>
</html>
